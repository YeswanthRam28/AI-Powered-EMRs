const BASE_URL = 'http://127.0.0.1:8000/patients/';

// ----------- CREATE Patient -----------
async function createPatient(name, age, gender) {
    try {
        const res = await fetch(BASE_URL, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({name, age, gender})
        });
        const data = await res.json();
        console.log('Created:', data);
        return data;
    } catch (err) {
        console.error('Error creating patient:', err);
    }
}

// ----------- LIST All Patients -----------
async function listPatients() {
    try {
        const res = await fetch(BASE_URL);
        const data = await res.json();
        console.log('All Patients:', data);
        return data;
    } catch (err) {
        console.error('Error listing patients:', err);
    }
}

// ----------- GET Patient by ID -----------
async function getPatientById(id) {
    try {
        const res = await fetch(`${BASE_URL}${id}/`);
        const data = await res.json();
        console.log(`Patient ${id}:`, data);
        return data;
    } catch (err) {
        console.error(`Error fetching patient ${id}:`, err);
    }
}

// ----------- UPDATE Patient -----------
async function updatePatient(id, updates) {
    try {
        const res = await fetch(`${BASE_URL}${id}/`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(updates)
        });
        const data = await res.json();
        console.log(`Updated Patient ${id}:`, data);
        return data;
    } catch (err) {
        console.error(`Error updating patient ${id}:`, err);
    }
}

// ----------- DELETE Patient -----------
async function deletePatient(id) {
    try {
        const res = await fetch(`${BASE_URL}${id}/`, { method: 'DELETE' });
        if (res.ok) console.log(`Deleted Patient ${id}`);
        else console.error('Failed to delete patient');
    } catch (err) {
        console.error(`Error deleting patient ${id}:`, err);
    }
}

// ----------- USAGE EXAMPLES -----------
// createPatient('John Doe', 45, 'Male');
// listPatients();
// getPatientById(1);
// updatePatient(1, {name: 'Jane Doe', age: 50});
// deletePatient(1);
